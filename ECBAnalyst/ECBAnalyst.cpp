// ECBAnalyst.cpp : Defines the entry point for the console application.
//

#include "stdafx.h"
#include <iostream>
#include "AnalystUtils.h"

std::vector<std::string> s_cipherTexts{
    "e86b6978dbc2b035f7f97e23267279a564792f435ffd1bb2e30a8548e08fe589",
    "1cf6ec25c2360ee51f8d46dbbd0378ce5aa7f6b10a33be1f283ca4e61bc95466",
    "9baa0119342c6a3f95fadb6e5ead4a6692575f3a238547f37201ca9173e66ba664c6080cae54ee63b2c1450550bb435c",
    "67316d089993aa83f609c063c9ea8e959884c680c2f38e7fc103d5d84ceb1246583f7dbe02d6102cd2a1a27bc4f11447",
    "82ecbcaf2a16a249d502abb6ac651cd840e51f9af50db5203a7ad9ab105bb33c41b06846098c67eb4e009cca24378175",
    "0be1366384368d63192a2ec9a56fe6b97a7a2d8bda1ab3dbc8ed15f2b99a5f37",
    "b9372cac1afe53e3f569c62bd9708fafaa1939057bc94db6a8f9a031f2abad81869f6392f6854e9212f53d6c6829a105",
    "efdbfe677181553d1a224a593c217a52b0bfff64762e8c0bd7e1ea3736e4cea0",
    "0ebf6ae96c91ebb2c92375afd1df8c1c021167c7be69ffe1064aef127fd12e16a3e2ea9255adf286a659d3755cc63a37",
    "af7fc70ded7209b5c074ed9d7916e3b55031a66c175d5023ecae1e4f351d632e",
    "3508939242a79c8deccd69a631074dee3127573e4aeef3069904a9a866603d337c423bedcbec203a01cfeb9b5d82f0e8",
    "606f97f1563cded55777dc50ba0ba71d9ed94e0e70e78b2a280860c102608c3e",
    "0ebf6ae96c91ebb2c92375afd1df8c1cc469165f5d8fe20fc655449106da111048e8dbe3929ca46c5bf4657cface818c",
    "acd819f12e3784fc595ef1dbcfe08e45ccc155f0f56c940b6010df4222ffdf34",
    "34800d9d6a92a65372b462b395dfd2ca0881e198a9e20c218f58d50137af71398458701e69f0ab4b7724971f45f3875b",
    "52164c6982b4f9cc190594ae72c23d1e40bb6faa80366e82cb36366bed905655",
    "acd819f12e3784fc595ef1dbcfe08e4539018cedec239f85c9d7521339535aa7a62adf110f1a29abd58917fa72d4f497",
    "f4a7bc9b62beb895455b9712ec7d4df19acf23ba61bd63785e668a0c46b87f6f",
    "3f1070a120005f5f9e20c91e078e8e1c0f5d7c88fa2f7e8ee6b7b4837d7f652746177a9b4ea445405cb7c326b9ec4ce8",
    "4d0f16f795b1030b6e7a8225b73c04298858d4105a46d0f1f252d27516250271",
    "174c446891db6a795c6ee73c56113c50461203ed49a52b316b3e0d628fd3e1ae01483c7fbf6bb40d14066dfcde3b5445",
    "d4764bfc460588bd889981fbf9475c73f23f8f882ef65f6f79d1883c9658dcc3",
    "7867bd73bc1cb8b5a9deaa7a12969eee0321a51fd1e48a93d606b2d1aae4470a94681004c80d3fcd30880f15ff208bf4",
    "be8f6a53c8600facade86ebe2d5ec5f69a4ceb6ad2eca9af1de3a50db8387b8e",
    "0a9e42c656a4491e0aee9f5ff38e950367e302a0c3e8c67c11a9f6cc0487265d",
    "cd3eeed8335790a6ac219416ddb1debddd98ca67d777025fad4829dac68ab532",
    "7676133b988de95306f55316aee698e35cf5696df3f361c9c95368a8c382532879f10bf50321a35217977b13bd7c5417",
    "c650e7aa4747f4371d67c733b98a5bb4a95e95de4b06b7eb9bfa2d4657d32877",
    "ee09c5dbae544e489f7321004a3441e26cf7a35d9d1d64585346bc657d58f5ab",
    "c37323a90918e35136607e3c5235909acb78cde3a0481df7c793d8877d801a45",
    "acd819f12e3784fc595ef1dbcfe08e45af56654def462ac22b43dbffb14fc04ae1a07ea98756eda8f436bfb78a405ca0",
    "94e10e33ca0572ea15456b37cccd4f3a29387a970e9ade27864d8dfb9da24607",
    "751efb29d89d585af58e9daab40ad34226c20033907851a783ce42c50a8b9d5333a2a1bee5b16e91514d45882a3d388a",
    "cccf86144d006c76a7dc70a6b8d58b619e5de0f161d7d25f4a5e2e2cb2b8deec",
    "0ef753fbffcdc08c2b226e970fb740ec5b249389667dc2a28df067cfb34d9585e7157930c54a2c81cf0cdaa4318052a7",
    "edaad82535330dc868bb3f111c059ff07f799e0ae8c5ac584201eb636f7eb519",
    "acd819f12e3784fc595ef1dbcfe08e456cf8a1546f66604fb42f2d2a0d372b07da56ac84f9e5ee31a169e76bd1194bd1",
    "67f3476e00d8147202b3ded02a57e94730e4e166d1d2f9c3df1b14562e6a89d4",
    "3f1070a120005f5f9e20c91e078e8e1c0f5d7c88fa2f7e8ee6b7b4837d7f652746177a9b4ea445405cb7c326b9ec4ce8",
    "4d0f16f795b1030b6e7a8225b73c04298858d4105a46d0f1f252d27516250271",
    "d07bdc723fb5fb52e237b25395428237831cd185f2155ce7079d5d3233c0929b5c0fae1684e10b10a1c9227fcd2916f4",
    "3cd9386882b0ad71bd5319720c60f092d0487ad40c681da56e7b6865e448c758",
    "510a2f5e6d89b184d025cc10d8c65122838aeeff67ff106618320ebb41c4a53d41016061367fe67914f0cf772b70454a",
    "2c8d7ab4b8aff672e0366fbc38fe50ce4934ad97fc776974a5733acd7a4df59f",
    "d8c68162f388f5f860ed9ea488cee76016b1e6ef48c502c60fc5ec6bbc3dc044b2313505c1430fe635e9b3c30872ffc4",
    "9e2da10d0bc7eba4b344ccf309fc6ee0b6df1a06785c9e963b5d44b4a57168a62ba3f3afc92ae6b9e51d6e40efb68f37",
    "d08dcd540a12fbab4ebcad5e78ab9213b4c3457eb180d6b2ccd648b4772b81afe71ec563c0c4cc88dba673eac74e1bbb",
    "93f4ba1f025902b4ef0a93686467adb5c17d9c79c97ea292bb09bbde1be506ed",
    "1df9b4fdec35f61bf8299e058f54b1636a6485b9669cd420ec8848aefea7eac6e737db884ad7c3e17782139ef8d959a7",
    "3dd9a0ec266ac7d3b902cb712f70eb52a434f4629af2ee02b942012d92325720",
    "c1f62fd9b19138234c843e4e41d824a345eba4300431c1df9033037f8f67080e6eb44dfa872effd892f987330b56faeb",
    "6f7027c0c3b20a5de4dd8c0db0641e7705fb292a70fb21c4f6007057f12f9578",
    "0176b7dbfde27a9d44d73253a5d1d3619fd2205c760b976e03c7445e25d60684154b50bc463e13646d4a86d231a94c25",
    "cf93980387890a1b415988d634a83ee78acf604e3b5650e15e40bad1a7676b76",
    "d1aa4f6578926542fbb6dd876cd20508d1aa4f6578926542fbb6dd876cd205087a4940e9da81dcf0a415937b0b31f79e",
    "6769483724e7ecbd52b65c3eb80298be22e285fb11e14b20351f869ce9ff3628f0058d95d461e887d16148f8520324e2",
    "a1f147e52535523f9f3d1e57294be8f3bd38520fbb0816a2b7aeb67b71ec0a64",
    "8b94ec14f213a93a7b52feeb16e190f6ef74473a539755b849068bb5d16f84617c85777b0c3a45faf48d53b2cea77ef4",
    "fc7a79f7b829f15e3ec53c154c98ac4f63c123becec563564923158670ac6b58",
    "6c241edd8359386f24bd357e77a7e2f492bc34c1fb08edcc5796932b2ffa4dd8e5a0088ada97129e1164c62aacc692b7",
    "fc7a79f7b829f15e3ec53c154c98ac4ffadd3f201680a6973b194a661a1dc84d",
    "4902d59e888333df41c4a1dbee93f82521bbc662a0e15dc5fbd9c8c5fb59eebd99be21cc945e4d861b0dc4ba3b0e193a",
    "b020c8082e41cae715a7f12d90bf0543e7f1c68cdbc7a45a4f929a9385bd9348",
    "8a27347d0000e94a595ab134256cd70b732e29644759203842316bfc8843b9fa8424deaab39847acac3c6172d8a8cbda",
    "c9429f97a5b755bff5af5f20847850160862c36c3df7b712b2c44754530e144d",
    "a4b2b54f8c051eb427bfeed9d334df39e168d24f1da08e77b839faa9e765cecb22bc15c90be9b32f22faf98aa61aa687",
    "35f536d3c9f85211314ba7b71206e8ba61bd36e3ae135ab7667d1dd053317d16",
    "fd20183a05bb7a4a317692fe876eee0367a51d852b34f854ac06bc83dfc7e6ed2d84f8932c07d36a4e9d89201d69d7cd",
    "4470e5e0bc813b2ee515ba406e6f7c6adbe90579cf3cf6a6157a5dd9cdc40438",
    "e17ece42946cace55904740018d2f6ce6c5934906dcb2d419c307a896e822a6695f455cc65cc2e413ea143febab747df",
    "413266a400b4f2a8352d0b6d55fc4a67662be6bb97891d5167a4da57e01a61b227779ddb694290accecea8fdd4fe1297",
    "7f686fe871084cd1a87804cd333b04008934ac85cc1f8e03f214cd1f292b60d07f80c4bb659a045f341af95628f8f50a",
    "cb7cec22e0298697b49329f1bbd3e59046584643e9e09795adba32dfedeb1a4f",
    "9377de1591cbbf99ce0d7b52895de20f2e7acd6ed577172190963bfa796443bc536f242ed8912efb994ea5629f204d44",
    "720ee133f0a80467daf5ac214cfb7ee2e637f302237607379b2cdeb7a5c17302",
    "8ea5e7ded07c0664046d7dae527668cc4af5fe9ddeb36167fbb52f25cacb6cd95e97368014a6bda3443c90c195a2cbf6",
    "24353fd15d983229dc9b532800a891b4f219f1ea4b749dfef2a8315c7e28b189",
    "0a1c2156a27a36cd959cb6e50adcef9bc389a3e874a4169946368ca0bcb87686f7f859734635a18076e2d95ff7836410",
    "a897470d6d774aca2a0cba464b1e9c25bed05743dbdb70c58363b9787721cd301cc8319a3c81f575273ad37e3ba9b568",
    "e0fb3a480405286e005b986cad68a8082cd533e1227d3f9fde79ed538abf5d08168cf0c66714fe7b1649701ed13c664e",
    "46872088bdcb484be7754d335878e4c34a334998883b3f190167547acd5b3823a7fa416da88e50e6839253664d8dd7c3",
    "96c684e1bc9d7c768511516858f38964394cfccb44a858842b58c320b3403f9d36a4be13b3533b5e54fb36501a9805ee",
    "1597e04b2f3615d50cf611b65f626486d3f0b63876e84848610d990ee30b0e3f",
    "c1adbe07cb4a253acccc650e2fb1047012b146fe0a3c4f5b874bc7dd681a61700029680b2dec2c9816e9647867a52ccb",
    "cd3eeed8335790a6ac219416ddb1debd2414696c45ec0d382b7979fbce6a177a"
};


int main()
{
    std::cout << "ECB cipher text index:\n";
    for (int i=0; i <s_cipherTexts.size(); ++i)
    {
        const auto val = analyst::SplitData({ s_cipherTexts[i].cbegin(), s_cipherTexts[i].cend() });
        int res = analyst::GetCountRepeatedBlocks(val);
        
        if (res)
        {
            std::cout << i << std::endl;
        }
    }

    return 0;
}

